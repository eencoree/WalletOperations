# Wallet

REST-приложение на FastAPI для управления кошельками.

Миграции через Alembic. Тестирование — `pytest`. Контейнеризация через Docker.

---

## Эндпоинты

### 1. Добавление нового кошелька

**POST** `/api/v1/wallets/add`

**Описание:** Запрос на создание нового кошелька. Тело запроса может быть пустым или содержать параметр `balance` типа
`float`

#### Пример запроса

```json
{
  "balance": 1335.7
}
```

### Пример успешного ответа

```json
{
  "uuid": "3d228b8c-f34e-42f9-bde1-83a0249f3f32",
  "balance": 1335.7
}
```

Код ответа: 201 Created

### Ошибки

- 422 Unprocessable Entity: Ошибка валидации входных данных.

### 2. Выполнение транзакции

**POST** `/api/v1/wallets/{wallet_uuid}/operation`

**Описание:** Запрос на пополнение или снятие средств. Тело запроса должно содержать параметр `operation_type` с
допустимыми значениями `DEPOSIT` или `WITHDRAW`, а также положительный параметр `amount` типа `float`.

#### Пример запроса

```json
{
  "operation_type": "DEPOSIT",
  "amount": 200
}
```

### Пример успешного ответа

```json
{
  "uuid": "3d228b8c-f34e-42f9-bde1-83a0249f3f32",
  "balance": 1535.7
}
```

Код ответа: 200 OK

### Ошибки

- 400 Bad Request: Переданное значение параметра `amount` не положительное или недостаточно средств для снятия.
- 404 Not Found: Кошелек с переданным UUID не найден.
- 422 Unprocessable Entity: Ошибка валидации. Неверно переданные параметры.

### 3. Получение кошелька

**GET** `/api/v1/wallets/{wallet_uuid}`

**Описание:** Запрос на получение информации о кошельке по UUID.

### Пример успешного ответа

```json
{
  "uuid": "3d228b8c-f34e-42f9-bde1-83a0249f3f32",
  "balance": 1335.7
}
```

Код ответа: 200 OK

### Ошибки

- 404 Not Found: Кошелек с переданным UUID не найден.
- 422 Unprocessable Entity: Ошибка валидации: неверный формат UUID.

### 4. Удаление кошелька по UUID

**DELETE** `/api/v1/wallets/{wallet_uuid}`

**Описание:** Запрос на удаление кошелька по UUID.

### Пример успешного ответа

Код ответа: 204 No Content

### Ошибки

- 404 Not Found: Кошелек с переданным UUID не найден.
- 422 Unprocessable Entity: Ошибка валидации: неверный формат UUID.

#### Сборка и запуск через Docker Compose:

```bash
docker-compose up --build -d
```

#### Запуск тестов внутри контейнера приложения

```bash
docker-compose exec app pytest
```

#### Структура проекта

| Путь                                                               | Назначение                       |
|--------------------------------------------------------------------|----------------------------------|
| [`wallet_app/`](wallet_app)                                        | Исходный код FastAPI-приложения  |
| [`tests/`](tests)                                                  | Тесты на Pytest                  |
| [`migration/versions/`](migration/versions)                        | Миграции Alembic                 |
| [`Wallet.postman_collection.json`](Wallet.postman_collection.json) | Postman-коллекция запросов API   |
| [`.env`](.env)                                                     | Переменные окружения для запуска |
